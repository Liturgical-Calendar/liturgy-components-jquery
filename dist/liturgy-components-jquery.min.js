/**
 * Calendars Select Plugin
 * @author [John Romano D'Orazio](https://github.com/JohnRDOrazio)
 * @license Apache-2.0
 * @version 1.0.0
 * @see https://github.com/Liturgical-Calendar/liturgy-components-jquery
 *
 * Description: Creates a select menu populated with available liturgical calendars from the Liturgical Calendar API
 * Usage: $('.calendars-select').liturgicalCalendarsSelect();
 */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}((function(e){let a=null;class t{static#e=[];static#a=[];static#t=[];#n=[];#i={};#o=[];#s=null;optionsBuilt=!1;constructor(e="en"){this.#s=new Intl.DisplayNames([e],{type:"region"})}static hasNationalCalendarWithDioceses(e){return t.#t.filter((a=>a?.calendar_id===e)).length>0}static addNationalCalendarWithDioceses(e){const a=t.#e.find((a=>a.calendar_id===e));t.#t.push(a)}static setNationalCalendars(e){t.#e=e}static setDiocesanCalendars(e){t.#a=e}addNationOption(e,a=!1){let t=`<option data-calendartype="national" value="${e.calendar_id}"${a?" selected":""}>${this.#s.of(e.calendar_id)}</option>`;this.#n.push(t)}addDioceseOption(e){let a=`<option data-calendartype="diocesan" value="${e.calendar_id}">${e.diocese}</option>`;this.#i[e.nation].push(a)}buildAllOptions(){this.optionsBuilt=!0,t.#a.forEach((e=>{!1===t.hasNationalCalendarWithDioceses(e.nation)&&t.addNationalCalendarWithDioceses(e.nation),!1===this.#i.hasOwnProperty(e.nation)&&(this.#i[e.nation]=[]),this.addDioceseOption(e)})),t.#e.sort(((e,a)=>this.#s.of(e.calendar_id).localeCompare(this.#s.of(a.calendar_id)))),t.#e.forEach((e=>{!1===t.hasNationalCalendarWithDioceses(e.calendar_id)&&("VA"===e.calendar_id?this.addNationOption(e,!0):this.addNationOption(e))})),t.#t.sort(((e,a)=>this.#s.of(e.calendar_id).localeCompare(this.#s.of(a.calendar_id)))),t.#t.forEach((e=>{this.addNationOption(e);let a=`<optgroup label="${this.#s.of(e.calendar_id)}">${this.#i[e.calendar_id].join("")}</optgroup>`;this.#o.push(a)}))}get nationsInnerHtml(){return this.#n.join("")}get diocesesInnerHtml(){return this.#o.join("")}}return e.fn.liturgicalCalendarsSelect=function(n){const i={selectClass:"",filter:"none",locale:"en"},o={};return this.each((function(){const s=e(this),l=e.extend({},i,n,s.data());let d=e("<select/>");if(this.classList.length&&d.addClass(this.className),!1===o.hasOwnProperty(l.locale)&&(o[l.locale]=new t(l.locale)),l.selectClass&&d.addClass(l.selectClass),null===a){if("undefined"==typeof LitCalApiClient&&"undefined"==typeof LiturgicalCalendarComponents)throw new Error("The LitCalApiClient class is not available. Please include the litcal-api-client.js file.");null===LitCalApiClient.metadata&&LitCalApiClient.init().then((e=>{if(!1===e)throw new Error("The LitCalApiClient class was unable to initialize.");if("object"!=typeof e)throw new Error("The LitCalApiClient class was unable to initialize: expected object, found "+typeof e+".");if(!1===e.hasOwnProperty("national_calendars")||!1===e.hasOwnProperty("diocesan_calendars"))throw new Error("The LitCalApiClient class was unable to initialize: expected object with `national_calendars` and `diocesan_calendars` properties.");a=LitCalApiClient.metadata;const{national_calendars:n,diocesan_calendars:i}=a;t.setNationalCalendars(n),t.setDiocesanCalendars(i),!1===o[l.locale].optionsBuilt&&o[l.locale].buildAllOptions(),c()}))}else!1===o[l.locale].optionsBuilt&&o[l.locale].buildAllOptions(),c();function c(){"nations"===l.filter?d.html(o[l.locale].nationsInnerHtml):"dioceses"===l.filter?d.html(o[l.locale].diocesesInnerHtml):d.html(o[l.locale].nationsInnerHtml+o[l.locale].diocesesInnerHtml),s.replaceWith(d)}}))},e}));
!function(t,a){"function"==typeof define&&define.amd?define([],a):"object"==typeof module&&module.exports?module.exports=a():t.LitCalApiClient=a()}(this,(function(){class t{static apiUrl="https://litcal.johnromanodorazio.com/api/dev";static paths=Object.freeze({calendars:"/calendars",calendar:"/calendar",events:"/events",easter:"/easter",decrees:"/decrees",data:"/data",missals:"/missals",tests:"/tests",schemas:"/schemas"});static metadata=null;static getCalendars(){return fetch(`${this.apiUrl}${this.paths.calendars}`).then((t=>{if(t.ok)return t.json()})).then((t=>{const{litcal_metadata:a}=t;return this.metadata=a,this.metadata})).catch((t=>(console.error(t),!1)))}static getCalendar(t=null){return fetch(`${this.apiUrl}${this.paths.calendar}${t?`/${t}`:""}`)}static getNationalCalendar(t,a=null){return fetch(`${this.apiUrl}${this.paths.calendar}/nation/${t}${a?`/${a}`:""}`)}static getDiocesanCalendar(t,a=null){return fetch(`${this.apiUrl}${this.paths.calendar}/diocese/${t}${a?`/${a}`:""}`)}static init(){return this.getCalendars()}}return t}));